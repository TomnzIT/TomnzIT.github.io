<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Terminal</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            font-family: "Fira Code", "Courier New", monospace;
            color: #00ff00;
            overflow: hidden;
        }
        #terminal {
            width: 80%;
            max-width: 800px;
            height: 90%;
            background-color: #000;
            border: 2px solid #00ff00;
            box-shadow: 0 0 10px #00ff00;
            padding: 10px;
            overflow-y: auto;
            white-space: pre-wrap;
            scrollbar-width: thin;
            scrollbar-color: #00ff00 transparent;
        }
        #terminal::-webkit-scrollbar {
            width: 8px;
        }
        #terminal::-webkit-scrollbar-thumb {
            background-color: #00ff00;
            border-radius: 4px;
        }
        .input {
            display: inline;
            border-right: 2px solid #00ff00;
            animation: blink 1s steps(2, start) infinite;
        }
        @keyframes blink {
            50% {
                border-color: transparent;
            }
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div id="output"></div>
        <div class="input-container">
            <span id="prompt">user@site:~$</span>
            <span id="user-input" class="input"></span>
        </div>
    </div>

    <script>
        const terminal = document.getElementById("terminal");
        const output = document.getElementById("output");
        const userInput = document.getElementById("user-input");
        const prompt = document.getElementById("prompt");

        const themes = {
            green: { background: "#000", color: "#00ff00" },
            blue: { background: "#001f3f", color: "#1e90ff" },
            white: { background: "#fff", color: "#000" },
        };

        const history = [];
        let historyIndex = -1;

        const commands = {
            ls: () => "projets  experiences  contact",
            cat: (arg) => {
                const files = {
                    projets: "1. Portfolio\n2. GitHub Repos\n3. Contributions Open Source",
                    experiences: "1. Consultant GRC @ Valeo\n2. Analyste Sécurité",
                    contact: "Email: user@example.com\nGitHub: https://github.com/username",
                };
                return files[arg] || `cat: ${arg}: No such file or directory`;
            },
            man: (arg) => {
                const manuals = {
                    ls: "ls: List files and directories.",
                    cat: "cat [file]: Display the contents of a file.",
                    theme: "theme [color]: Change the terminal theme (green, blue, white).",
                };
                return manuals[arg] || `No manual entry for ${arg}`;
            },
            theme: (arg) => {
                if (themes[arg]) {
                    document.body.style.backgroundColor = themes[arg].background;
                    document.body.style.color = themes[arg].color;
                    terminal.style.borderColor = themes[arg].color;
                    terminal.style.boxShadow = `0 0 10px ${themes[arg].color}`;
                    return `Theme changed to ${arg}`;
                }
                return `theme: ${arg}: Invalid theme. Available themes: green, blue, white.`;
            },
            history: () => history.join("\n"),
            echo: (arg) => arg,
            clear: () => {
                output.innerHTML = "";
                return "";
            },
            help: () =>
                "Available commands:\nls, cat [file], man [command], theme [color], echo [text], history, clear, help",
            pwd: () => "/home/user",
            secret: () => "You found the easter egg! Keep exploring!",
        };

        const typeEffect = (text, element, speed = 50) => {
            let i = 0;
            return new Promise((resolve) => {
                const interval = setInterval(() => {
                    element.textContent += text[i];
                    i++;
                    if (i === text.length) {
                        clearInterval(interval);
                        resolve();
                    }
                }, speed);
            });
        };

        const processCommand = async (input) => {
            const [cmd, ...args] = input.split(" ");
            const outputText = commands[cmd]
                ? await commands[cmd](args.join(" "))
                : `${cmd}: command not found`;

            if (outputText !== "") {
                const outputLine = document.createElement("div");
                await typeEffect(outputText, outputLine);
                output.appendChild(outputLine);
            }
        };

        const handleInput = async (e) => {
            if (e.key === "Enter") {
                const input = userInput.textContent.trim();
                if (input) {
                    history.push(input);
                    historyIndex = history.length;
                    const inputLine = document.createElement("div");
                    inputLine.textContent = `${prompt.textContent} ${input}`;
                    output.appendChild(inputLine);

                    userInput.textContent = "";
                    await processCommand(input);

                    terminal.scrollTop = terminal.scrollHeight;
                }
            } else if (e.key === "ArrowUp" || e.key === "ArrowDown") {
                if (e.key === "ArrowUp") historyIndex = Math.max(0, historyIndex - 1);
                if (e.key === "ArrowDown")
                    historyIndex = Math.min(history.length, historyIndex + 1);
                userInput.textContent = history[historyIndex] || "";
            } else if (e.key === "Backspace") {
                userInput.textContent = userInput.textContent.slice(0, -1);
            } else if (e.key.length === 1) {
                userInput.textContent += e.key;
            }
        };

        window.onload = async () => {
            const bootText = [
                "Initializing system...",
                "Loading terminal modules...",
                "Welcome to the interactive terminal!",
            ];
            for (const line of bootText) {
                const bootLine = document.createElement("div");
                await typeEffect(line, bootLine);
                output.appendChild(bootLine);
            }
            document.addEventListener("keydown", handleInput);
        };
    </script>
</body>
</html>