<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebOS Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007acc;
            --background-color: #1a1a1a;
            --text-color: #ffffff;
            --success-color: #27c93f;
            --error-color: #ff4444;
        }

        /* Base styles */
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            touch-action: none;
        }

        /* Boot screen */
        #boot-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
        }

        .loading-bar {
            width: 300px;
            height: 4px;
            background-color: #333;
            margin-top: 20px;
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress {
            width: 0%;
            height: 100%;
            background-color: white;
            transition: width 3s linear;
        }

        /* Login screen */
        #login-container {
            display: none;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            height: 100vh;
            justify-content: center;
            align-items: center;
        }

        .login-box {
            background-color: rgba(30, 30, 30, 0.95);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.6);
            text-align: center;
            width: 350px;
            backdrop-filter: blur(10px);
        }

        /* Desktop environment */
        #desktop {
            display: none;
            position: relative;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(45deg, #1a1a1a, #2a2a2a);
            overflow: hidden;
        }

        /* Window styles */
        .app-window {
            display: none;
            position: absolute;
            background-color: #2d2d2d;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            min-width: 400px;
            min-height: 300px;
            overflow: hidden;
            transition: transform 0.3s ease-out;
        }

        .window-header {
            background-color: #252525;
            color: white;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            user-select: none;
        }

        .window-content {
            padding: 20px;
            height: calc(100% - 48px);
            overflow: auto;
            color: #ddd;
        }

        /* Enhanced Terminal */
        #terminal {
            font-family: 'Fira Code', monospace;
        }

        .terminal-output div {
            margin: 5px 0;
            white-space: pre-wrap;
        }

        /* New Application Styles */
        .calculator {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            padding: 10px;
        }

        .calculator-display {
            grid-column: span 4;
            background: #1a1a1a;
            padding: 10px;
            text-align: right;
            font-size: 1.5em;
            border-radius: 4px;
        }

        .music-player {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .playlist {
            width: 100%;
            margin-top: 15px;
        }

        /* System Notifications */
        .notification-center {
            position: fixed;
            right: 20px;
            top: 20px;
            width: 300px;
            max-height: 80vh;
            overflow-y: auto;
            background: rgba(40, 40, 40, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 15px;
            display: none;
        }

        /* Context Menu */
        .context-menu {
            position: fixed;
            background: rgba(50, 50, 50, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 6px;
            padding: 8px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
        }

        .context-menu-item {
            padding: 8px 20px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .context-menu-item:hover {
            background: rgba(255,255,255,0.1);
        }

        /* Animations */
        @keyframes windowEntry {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        @keyframes floating {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Boot Screen -->
    <div id="boot-screen">
        <h1>WebOS Portfolio</h1>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-container">
        <div class="login-box">
            <div class="user-avatar">üë§</div>
            <h2>Welcome to WebOS</h2>
            <input type="text" id="username" placeholder="Username" class="modern-input">
            <div style="position: relative;">
                <input type="password" id="password" placeholder="Password" class="modern-input">
                <span id="toggle-password">üëÅÔ∏è</span>
            </div>
            <button onclick="login()" class="modern-button">Login</button>
            <p style="margin-top: 15px; font-size: 0.9em; color: #888;">
                Demo credentials: guest/demo
            </p>
        </div>
    </div>

    <!-- Desktop Environment -->
    <div id="desktop">
        <!-- Desktop Icons -->
        <div class="desktop-icons">
            <!-- Existing icons... -->
            <div class="desktop-icon" onclick="openApp('calculator')">
                <div class="icon-image">üßÆ</div>
                <span>Calculator</span>
            </div>
            <div class="desktop-icon" onclick="openApp('music')">
                <div class="icon-image">üéµ</div>
                <span>Music Player</span>
            </div>
        </div>

        <!-- New Applications -->
        <div id="calculator" class="app-window" style="width: 300px; height: 400px;">
            <div class="window-header">
                <span>Calculator</span>
                <div class="terminal-controls">
                    <div class="terminal-button close-button" onclick="closeApp('calculator')"></div>
                </div>
            </div>
            <div class="window-content">
                <div class="calculator">
                    <div class="calculator-display" id="calc-display">0</div>
                    <button class="modern-button" onclick="clearDisplay()">C</button>
                    <button class="modern-button" onclick="appendToDisplay('¬±')">¬±</button>
                    <button class="modern-button" onclick="appendToDisplay('%')">%</button>
                    <button class="modern-button" onclick="appendToDisplay('/')">√∑</button>
                    <button class="modern-button" onclick="appendToDisplay('7')">7</button>
                    <button class="modern-button" onclick="appendToDisplay('8')">8</button>
                    <button class="modern-button" onclick="appendToDisplay('9')">9</button>
                    <button class="modern-button" onclick="appendToDisplay('*')">√ó</button>
                    <button class="modern-button" onclick="appendToDisplay('4')">4</button>
                    <button class="modern-button" onclick="appendToDisplay('5')">5</button>
                    <button class="modern-button" onclick="appendToDisplay('6')">6</button>
                    <button class="modern-button" onclick="appendToDisplay('-')">‚àí</button>
                    <button class="modern-button" onclick="appendToDisplay('1')">1</button>
                    <button class="modern-button" onclick="appendToDisplay('2')">2</button>
                    <button class="modern-button" onclick="appendToDisplay('3')">3</button>
                    <button class="modern-button" onclick="appendToDisplay('+')">+</button>
                    <button class="modern-button" onclick="appendToDisplay('0')" style="grid-column: span 2;">0</button>
                    <button class="modern-button" onclick="appendToDisplay('.')">.</button>
                    <button class="modern-button" onclick="calculate()">=</button>
                </div>
            </div>
        </div>

        <div id="music" class="app-window" style="width: 400px; height: 500px;">
            <div class="window-header">
                <span>Music Player</span>
                <div class="terminal-controls">
                    <div class="terminal-button close-button" onclick="closeApp('music')"></div>
                </div>
            </div>
            <div class="window-content">
                <div class="music-player">
                    <audio id="audio-player" controls></audio>
                    <div class="playlist">
                        <div class="playlist-item" onclick="playTrack('demo')">Demo Track 1</div>
                        <div class="playlist-item" onclick="playTrack('demo2')">Demo Track 2</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification Center -->
        <div class="notification-center" id="notification-center"></div>

        <!-- Context Menu -->
        <div class="context-menu" id="context-menu">
            <div class="context-menu-item" onclick="openApp('terminal')">Open Terminal</div>
            <div class="context-menu-item" onclick="openApp('settings')">Settings</div>
            <hr>
            <div class="context-menu-item" onclick="location.reload()">Refresh</div>
        </div>

        <!-- Taskbar -->
        <div id="taskbar">
            <div class="start-menu" onclick="toggleStartMenu()">Start</div>
            <div class="taskbar-items">
                <div class="taskbar-item" id="taskbar-clock"></div>
                <div class="network-status" id="network-status"></div>
                <div class="battery-status" id="battery-status">üîã 100%</div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced System Constants
        const SYSTEM = {
            VERSION: 'WebOS 2.1',
            DEVELOPER: 'John Doe',
            SESSION_TIMEOUT: 900000 // 15 minutes
        };

        // Enhanced Window Management
        class WindowManager {
            constructor() {
                this.windows = new Map();
                this.zIndex = 1000;
            }

            open(appId) {
                const app = document.getElementById(appId);
                if(app) {
                    app.style.display = 'block';
                    this.bringToFront(app);
                    app.style.animation = 'windowEntry 0.3s ease-out';
                }
            }

            bringToFront(element) {
                this.zIndex++;
                element.style.zIndex = this.zIndex;
            }

            // Add more window management methods...
        }

        // System Initialization
        const windowManager = new WindowManager();

        // Enhanced Terminal Commands
        const commands = {
            help: () => `Available commands:
                        help - Show this help
                        clear - Clear terminal
                        about - About me
                        projects - List projects
                        theme [name] - Change theme
                        time - Show system time
                        calc [expression] - Calculator
                        weather - Get weather info`,
            
            clear: () => terminalOutput.innerHTML = '',
            about: () => `${SYSTEM.DEVELOPER} - ${SYSTEM.VERSION}`,
            theme: (arg) => applyTheme(arg),
            time: () => new Date().toLocaleTimeString(),
            weather: () => fetchWeather(),
            calc: (expr) => eval(expr) || 'Invalid expression'
        };

        // Enhanced Calculator Logic
        let currentCalculation = '0';

        function appendToDisplay(value) {
            if(currentCalculation === '0') currentCalculation = '';
            currentCalculation += value;
            updateDisplay();
        }

        function clearDisplay() {
            currentCalculation = '0';
            updateDisplay();
        }

        function calculate() {
            try {
                currentCalculation = eval(currentCalculation).toString();
                updateDisplay();
            } catch {
                showNotification('Calculation error', 'error');
            }
        }

        function updateDisplay() {
            document.getElementById('calc-display').textContent = currentCalculation;
        }

        // Music Player Logic
        const audioPlayer = new Audio();
        const tracks = {
            demo: 'https://files.freemusicarchive.org/storage-freemusicarchive-org/music/Music_for_Video/springtide/Sounds_strange_weird_but_unmistakably_romantic_Vol1/springtide_-_03_-_We_Are_Going_To_Disco.mp3',
            demo2: 'https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Tours/Enthusiast/Tours_-_Enthusiast_-_01_PolyCoat.mp3'
        };

        function playTrack(trackId) {
            audioPlayer.src = tracks[trackId];
            audioPlayer.play();
        }

        // Enhanced Notification System
        class NotificationSystem {
            constructor() {
                this.notificationCenter = document.getElementById('notification-center');
            }

            show(message, type = 'info', duration = 3000) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                this.notificationCenter.appendChild(notification);
                
                setTimeout(() => notification.remove(), duration);
                this.updateVisibility();
            }

            updateVisibility() {
                this.notificationCenter.style.display = 
                    this.notificationCenter.children.length > 0 ? 'block' : 'none';
            }
        }

        // System Initialization
        const notificationSystem = new NotificationSystem();

        // Enhanced Context Menu
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            const contextMenu = document.getElementById('context-menu');
            contextMenu.style.display = 'block';
            contextMenu.style.left = `${e.clientX}px`;
            contextMenu.style.top = `${e.clientY}px`;
        });

        document.addEventListener('click', () => {
            document.getElementById('context-menu').style.display = 'none';
        });

        // Battery Status Monitoring
        navigator.getBattery?.()?.then(battery => {
            const updateBatteryStatus = () => {
                document.getElementById('battery-status').textContent = 
                    `${battery.charging ? '‚ö°' : 'üîã'} ${Math.floor(battery.level * 100)}%`;
            };
            
            battery.addEventListener('levelchange', updateBatteryStatus);
            battery.addEventListener('chargingchange', updateBatteryStatus);
            updateBatteryStatus();
        });

        // Session Management
        let sessionTimeout;
        function resetSessionTimeout() {
            clearTimeout(sessionTimeout);
            sessionTimeout = setTimeout(() => {
                location.reload();
            }, SYSTEM.SESSION_TIMEOUT);
        }

        // Event Listeners
        document.addEventListener('mousemove', resetSessionTimeout);
        document.addEventListener('keypress', resetSessionTimeout);

        // Initialize System
        function initializeDesktop() {
            loadUserPreferences();
            checkSystemStatus();
            loadProjects();
            updateNetworkStatus();
            windowManager.open('terminal');
            
            setInterval(() => {
                document.getElementById('taskbar-clock').textContent = 
                    new Date().toLocaleTimeString();
            }, 1000);
        }

        // ... (remaining initialization code from previous versions) ...
    </script>
</body>
</html>
